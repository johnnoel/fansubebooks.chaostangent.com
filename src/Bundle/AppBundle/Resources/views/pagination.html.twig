{# route, route_params, page, pages #}
{% if route_params is not defined %}
    {% set route_params = {} %}
{% endif %}

<nav class="pagination">
    {% if page > 1 %}
    <a href="{{ path(route, route_params|merge({ 'page': page - 1 })) }}" class="prev">&larr; Previous <span>page</span></a>
    {% else %}
    <div class="prev">&larr; Previous <span>page</span></div>
    {% endif %}

    <ul class="pages">
        {% if pages < 7 %}
        {% for i in 1..pages %}
        <li><a href="{{ path(route, route_params|merge({ 'page': i })) }}"{% if i == page %} class="on"{% endif %}>{{ i }}</a></li>
        {% endfor %}
        {% else %}

        {% for i in 1..3 %}
        <li><a href="{{ path(route, route_params|merge({ 'page': i })) }}"{% if i == page %} class="on"{% endif %}>{{ i }}</a></li>
        {% endfor %}
        {% if page > 5 %}
        <li class="spacer">&hellip;</li>
        {% endif %}

        {% for i in (page - 1)..(page + 1) %}
        {% if i > 3 and i < (pages - 2) %}
        <li><a href="{{ path(route, route_params|merge({ 'page': i })) }}"{% if i == page %} class="on"{% endif %}>{{ i }}</a></li>
        {% endif %}
        {% endfor %}

        {% if page < (pages - 4) %}
        <li class="spacer">&hellip;</li>
        {% endif %}

        {% for i in (pages - 2)..pages %}
        <li><a href="{{ path(route, route_params|merge({ 'page': i })) }}"{% if i == page %} class="on"{% endif %}>{{ i }}</a></li>
        {% endfor %}
        {% endif %}
    </ul>

    {% if page < pages %}
    <a href="{{ path(route, route_params|merge({ 'page': page + 1 })) }}" class="next">Next <span>page</span> &rarr;</a>
    {% else %}
    <div class="next">Next <span>page</span> &rarr;</div>
    {% endif %}
</nav>
